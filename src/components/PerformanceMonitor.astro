---
// æ€§èƒ½ç›£æ§çµ„ä»¶ - åœ¨é–‹ç™¼æ¨¡å¼ä¸‹é¡¯ç¤ºæ€§èƒ½æŒ‡æ¨™
const isDev = import.meta.env.DEV;
---

{isDev && (
  <div id="perf-monitor" style="position: fixed; bottom: 10px; right: 10px; background: rgba(0,0,0,0.8); color: #0f0; padding: 10px; border-radius: 8px; font-family: monospace; font-size: 12px; z-index: 9999;">
    <div id="perf-stats">è½½å…¥ä¸­...</div>
  </div>
)}

<script is:inline>
  if (typeof window !== 'undefined' && window.performance) {
    window.addEventListener('load', () => {
      setTimeout(() => {
        const perfData = window.performance.timing;
        const pageLoadTime = perfData.loadEventEnd - perfData.navigationStart;
        const connectTime = perfData.responseEnd - perfData.requestStart;
        const renderTime = perfData.domComplete - perfData.domLoading;
        
        const monitor = document.getElementById('perf-stats');
        if (monitor) {
          monitor.innerHTML = `
            âš¡ é¡µé¢è½½å…¥: ${pageLoadTime}ms<br>
            ğŸ”Œ è¿æ¥æ—¶é—´: ${connectTime}ms<br>
            ğŸ¨ æ¸²æŸ“æ—¶é—´: ${renderTime}ms<br>
            ğŸ“¦ DOM èŠ‚ç‚¹: ${document.getElementsByTagName('*').length}
          `;
        }

        // ä½¿ç”¨ PerformanceObserver ç›£æ§è³‡æº
        if ('PerformanceObserver' in window) {
          const observer = new PerformanceObserver((list) => {
            for (const entry of list.getEntries()) {
              if (entry.duration > 100) {
                console.warn(`âš ï¸ æ…¢é€Ÿèµ„æº: ${entry.name} (${Math.round(entry.duration)}ms)`);
              }
            }
          });
          observer.observe({ entryTypes: ['resource', 'navigation'] });
        }
      }, 0);
    });
  }
</script>